Loading /home/seita/BIDMach/lib/bidmach_init.scala...
import BIDMat.{CMat, CSMat, DMat, Dict, FMat, FND, GMat, GDMat, GIMat, GLMat, GSMat, GSDMat, HMat, IDict, Image, IMat, LMat, Mat, SMat, SBMat, SDMat}
import BIDMat.MatFunctions._
import BIDMat.SciFunctions._
import BIDMat.Solvers._
import BIDMat.Plotting._
import BIDMach.Learner
import BIDMach.models.{FM, GLM, KMeans, KMeansw, LDA, LDAgibbs, Model, NMF, SFA, RandomForest}
import BIDMach.networks.DNN
import BIDMach.datasources.{DataSource, MatDS, FilesDS, SFilesDS}
import BIDMach.mixins.{CosineSim, Perplexity, Top, L1Regularizer, L2Regularizer}
import BIDMach.updaters.{ADAGrad, Batch, BatchNorm, IncMult, IncNorm, Telescoping}
import BIDMach.causal.IPTW
1 CUDA device found, CUDA version 7.0

Loading scripts/bn_test.ssc...
data: BIDMat.FMat =
   0   1   1   0   0   0   0   0   1   1   1   0   0   0   0   1   2   1   2   2   0   1   0   0   0   2   1   2   0   2   1   2   2   1   1   2   0   1   0   0   0   2   2   1   0   1   0   0   1...
   0   2   0   2   0   1   2   1   0   0   0   2   0   2   1   2   0   0   2   1   1   1   1   1   1   1   0   0   0   0   0   2   0   0   1   2   2   1   1   0   0   0   0   0   1   0   0   0   0...
   0   1   1   1   1   0   1   1   0   1   1   2   0   1   1   0   0   0   2   2   0   0   0   0   1   1   1   2   0   0   1   2   2   1   0   0   2   1   0   0   1   2   2   1   2   0   0   1   1...
  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  .. ...data_50k: BIDMat.FMat =
   0   1   1   0   0   0   0   0   1   1   1   0   0   0   0   1   2   1   2   2   0   1   0   0   0   2   1   2   0   2   1   2   2   1   1   2   0   1   0   0   0   2   2   1   0   1   0   0   1...
   0   2   0   2   0   1   2   1   0   0   0   2   0   2   1   2   0   0   2   1   1   1   1   1   1   1   0   0   0   0   0   2   0   0   1   2   2   1   1   0   0   0   0   0   1   0   0   0   0...
   0   1   1   1   1   0   1   1   0   1   1   2   0   1   1   0   0   0   2   2   0   0   0   0   1   1   1   2   0   0   1   2   2   1   0   0   2   1   0   0   1   2   2   1   2   0   0   1   1...
  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  .. ...dag: BIDMat.SMat =
(   0,   2)   1
(   0,   3)   1
(   1,   3)   1
(   3,   4)   1
states: BIDMat.IMat =
   2
   2
   2
  ..
nn: BIDMach.Learner = Learner(BIDMach.datasources.MatDS@12b89aea,BIDMach.models.BayesNet@15c28240,null,BIDMach.updaters.IncNorm@14f542e9,BIDMach.models.BayesNet$xopts$1@71fbd9be)
opts: BIDMach.Learner.Options with BIDMach.models.BayesNet.Opts with BIDMach.datasources.MatDS.Opts with BIDMach.updaters.IncNorm.Opts = BIDMach.models.BayesNet$xopts$1@71fbd9be
opts.npasses: Int = 200
opts.useGPU: Boolean = true
opts.batchSize: Int = 50000
opts.updateAll: Boolean = true
Option Name       Type          Value
===========       ====          =====
addConstFeat      boolean       false
autoReset         boolean       true
batchSize         int           50000
checkPointFile    String        null
checkPointInterval  float         0.0
copiesForSAME     int           5
cumScore          int           0
debug             int           0
debugMem          boolean       false
dim               int           5
doubleScore       boolean       false
evalStep          int           11
featThreshold     Mat           null
featType          int           1
isprob            boolean       false
npasses           int           200
numSamplesBurn    int           0
nzPerColumn       int           0
power             float         0.0
pstep             float         0.01
putBack           int           1
resFile           String        null
sample            float         1.0
samplingRate      int           1
sizeMargin        float         3.0
startBlock        int           8000
updateAll         boolean       true
useCache          boolean       true
useDouble         boolean       false
useGPU            boolean       true
warmup            long          0
randSeed = 0
pass= 0
0.62761  0 KLDiv
pass= 1
0.27825  1 KLDiv
pass= 2
0.17124  2 KLDiv
pass= 3
0.10810  3 KLDiv
pass= 4
0.069796  4 KLDiv
pass= 5
0.044549  5 KLDiv
pass= 6
0.028420  6 KLDiv
pass= 7
0.018545  7 KLDiv
pass= 8
0.012769  8 KLDiv
pass= 9
0.0086995  9 KLDiv
pass=10
0.0061106  10 KLDiv
pass=11
0.0040937  11 KLDiv
pass=12
0.0029886  12 KLDiv
pass=13
0.0020107  13 KLDiv
pass=14
0.0014720  14 KLDiv
pass=15
0.00091733  15 KLDiv
pass=16
0.00080839  16 KLDiv
pass=17
0.00063381  17 KLDiv
pass=18
0.00044818  18 KLDiv
pass=19
0.00024890  19 KLDiv
pass=20
0.00016410  20 KLDiv
pass=21
0.00015101  21 KLDiv
pass=22
0.00019698  22 KLDiv
pass=23
0.00019647  23 KLDiv
pass=24
0.00015250  24 KLDiv
pass=25
0.00017321  25 KLDiv
pass=26
0.00021408  26 KLDiv
pass=27
0.00014168  27 KLDiv
pass=28
0.00021475  28 KLDiv
pass=29
0.00024587  29 KLDiv
pass=30
0.00022956  30 KLDiv
pass=31
0.00029232  31 KLDiv
pass=32
0.00024734  32 KLDiv
pass=33
0.00032784  33 KLDiv
pass=34
0.00027200  34 KLDiv
pass=35
0.00036620  35 KLDiv
pass=36
0.00044065  36 KLDiv
pass=37
0.00034957  37 KLDiv
pass=38
0.00033188  38 KLDiv
pass=39
0.00028859  39 KLDiv
pass=40
0.00027401  40 KLDiv
pass=41
0.00016050  41 KLDiv
pass=42
0.00015193  42 KLDiv
pass=43
0.00022177  43 KLDiv
pass=44
0.00017481  44 KLDiv
pass=45
0.00022788  45 KLDiv
pass=46
0.00020265  46 KLDiv
pass=47
0.00023175  47 KLDiv
pass=48
0.00015202  48 KLDiv
pass=49
0.00023699  49 KLDiv
pass=50
0.00014605  50 KLDiv
pass=51
0.00023511  51 KLDiv
pass=52
0.00027412  52 KLDiv
pass=53
0.00031379  53 KLDiv
pass=54
0.00030631  54 KLDiv
pass=55
0.00026920  55 KLDiv
pass=56
0.00024251  56 KLDiv
pass=57
0.00012881  57 KLDiv
pass=58
0.00018061  58 KLDiv
pass=59
0.00012658  59 KLDiv
pass=60
0.00014995  60 KLDiv
pass=61
0.00011145  61 KLDiv
pass=62
0.00013170  62 KLDiv
pass=63
0.00014087  63 KLDiv
pass=64
0.00020919  64 KLDiv
pass=65
0.00019817  65 KLDiv
pass=66
0.00018870  66 KLDiv
pass=67
0.00021455  67 KLDiv
pass=68
0.00017708  68 KLDiv
pass=69
0.00022291  69 KLDiv
pass=70
0.00028976  70 KLDiv
pass=71
0.00031805  71 KLDiv
pass=72
0.00030486  72 KLDiv
pass=73
0.00023977  73 KLDiv
pass=74
0.00013842  74 KLDiv
pass=75
0.00015935  75 KLDiv
pass=76
9.0156e-05  76 KLDiv
pass=77
0.00010785  77 KLDiv
pass=78
0.00012715  78 KLDiv
pass=79
0.00010270  79 KLDiv
pass=80
0.00019059  80 KLDiv
pass=81
0.00024268  81 KLDiv
pass=82
0.00021490  82 KLDiv
pass=83
0.00015388  83 KLDiv
pass=84
0.00015361  84 KLDiv
pass=85
0.00015815  85 KLDiv
pass=86
0.00024444  86 KLDiv
pass=87
0.00033038  87 KLDiv
pass=88
0.00018222  88 KLDiv
pass=89
0.00016273  89 KLDiv
pass=90
0.00013217  90 KLDiv
pass=91
0.00014958  91 KLDiv
pass=92
0.00016581  92 KLDiv
pass=93
0.00021365  93 KLDiv
pass=94
0.00025057  94 KLDiv
pass=95
0.00019343  95 KLDiv
pass=96
0.00016920  96 KLDiv
pass=97
0.00010937  97 KLDiv
pass=98
0.00014317  98 KLDiv
pass=99
0.00016170  99 KLDiv
pass=100
0.00021404  100 KLDiv
pass=101
0.00014408  101 KLDiv
pass=102
0.00015023  102 KLDiv
pass=103
0.00017976  103 KLDiv
pass=104
0.00023629  104 KLDiv
pass=105
0.00019800  105 KLDiv
pass=106
0.00012088  106 KLDiv
pass=107
0.00013925  107 KLDiv
pass=108
9.9431e-05  108 KLDiv
pass=109
0.00011510  109 KLDiv
pass=110
9.6341e-05  110 KLDiv
pass=111
7.5246e-05  111 KLDiv
pass=112
9.4760e-05  112 KLDiv
pass=113
0.00016664  113 KLDiv
pass=114
0.00012965  114 KLDiv
pass=115
0.00012151  115 KLDiv
pass=116
0.00014565  116 KLDiv
pass=117
0.00017424  117 KLDiv
pass=118
0.00021406  118 KLDiv
pass=119
0.00012243  119 KLDiv
pass=120
0.00015476  120 KLDiv
pass=121
0.00018615  121 KLDiv
pass=122
0.00013012  122 KLDiv
pass=123
0.00016346  123 KLDiv
pass=124
0.00017672  124 KLDiv
pass=125
0.00021313  125 KLDiv
pass=126
0.00022948  126 KLDiv
pass=127
0.00017305  127 KLDiv
pass=128
0.00015413  128 KLDiv
pass=129
0.00012577  129 KLDiv
pass=130
0.00018749  130 KLDiv
pass=131
0.00018676  131 KLDiv
pass=132
0.00024261  132 KLDiv
pass=133
0.00020321  133 KLDiv
pass=134
0.00014261  134 KLDiv
pass=135
0.00012432  135 KLDiv
pass=136
7.3518e-05  136 KLDiv
pass=137
8.7238e-05  137 KLDiv
pass=138
9.4351e-05  138 KLDiv
pass=139
0.00010107  139 KLDiv
pass=140
0.00016165  140 KLDiv
pass=141
0.00015267  141 KLDiv
pass=142
0.00013108  142 KLDiv
pass=143
0.00021777  143 KLDiv
pass=144
0.00017238  144 KLDiv
pass=145
0.00019474  145 KLDiv
pass=146
0.00015404  146 KLDiv
pass=147
0.00010977  147 KLDiv
pass=148
0.00011154  148 KLDiv
pass=149
0.00022351  149 KLDiv
pass=150
0.00020792  150 KLDiv
pass=151
0.00021096  151 KLDiv
pass=152
0.00014006  152 KLDiv
pass=153
0.00014989  153 KLDiv
pass=154
0.00016588  154 KLDiv
pass=155
0.00020212  155 KLDiv
pass=156
0.00018035  156 KLDiv
pass=157
0.00016322  157 KLDiv
pass=158
0.00017116  158 KLDiv
pass=159
0.00014196  159 KLDiv
pass=160
0.00015544  160 KLDiv
pass=161
0.00015864  161 KLDiv
pass=162
0.00015089  162 KLDiv
pass=163
0.00014173  163 KLDiv
pass=164
0.00013878  164 KLDiv
pass=165
0.00012800  165 KLDiv
pass=166
0.00016703  166 KLDiv
pass=167
0.00019288  167 KLDiv
pass=168
0.00020404  168 KLDiv
pass=169
0.00019534  169 KLDiv
pass=170
0.00021393  170 KLDiv
pass=171
0.00017474  171 KLDiv
pass=172
0.00020774  172 KLDiv
pass=173
0.00017334  173 KLDiv
pass=174
0.00013247  174 KLDiv
pass=175
0.00020687  175 KLDiv
pass=176
0.00016699  176 KLDiv
pass=177
0.00013111  177 KLDiv
pass=178
0.00010590  178 KLDiv
pass=179
0.00011526  179 KLDiv
pass=180
0.00012259  180 KLDiv
pass=181
0.00014946  181 KLDiv
pass=182
0.00016475  182 KLDiv
pass=183
0.00023161  183 KLDiv
pass=184
0.00013264  184 KLDiv
pass=185
0.00017256  185 KLDiv
pass=186
0.00013700  186 KLDiv
pass=187
9.8845e-05  187 KLDiv
pass=188
0.00010522  188 KLDiv
pass=189
0.00012277  189 KLDiv
pass=190
8.8638e-05  190 KLDiv
pass=191
0.00016030  191 KLDiv
pass=192
0.00015457  192 KLDiv
pass=193
0.00010426  193 KLDiv
pass=194
0.00016317  194 KLDiv
pass=195
0.00015496  195 KLDiv
pass=196
0.00013157  196 KLDiv
pass=197
9.5822e-05  197 KLDiv
pass=198
7.3259e-05  198 KLDiv
pass=199
7.2316e-05  199 KLDiv
Time=5.8100 secs, gflops=6.05
java.lang.IndexOutOfBoundsException: 0
  at scala.collection.mutable.ListBuffer.apply(ListBuffer.scala:126)
  at BIDMach.Learner$.scores2FMat(Learner.scala:798)
  at BIDMach.Learner.retrain(Learner.scala:134)
  at BIDMach.Learner.train(Learner.scala:56)
  ... 54 elided
res4: BIDMat.Mat = 0.70419,0.29581,0.60468,0.39532,0.94893,0.051068,0.19813,0.80187,0.29046,0.40924,0.30031,0.047355,0.24634,0.70631,0.89009,0.089280,0.020626,0.50193,0.29055,0.20752,0.099583,0.90042,0.40250,0.59750,0.99066,0.0093382
