Loading /home/seita/BIDMach/lib/bidmach_init.scala...
import BIDMat.{CMat, CSMat, DMat, Dict, FMat, FND, GMat, GDMat, GIMat, GLMat, GSMat, GSDMat, HMat, IDict, Image, IMat, LMat, Mat, SMat, SBMat, SDMat}
import BIDMat.MatFunctions._
import BIDMat.SciFunctions._
import BIDMat.Solvers._
import BIDMat.Plotting._
import BIDMach.Learner
import BIDMach.models.{FM, GLM, KMeans, KMeansw, LDA, LDAgibbs, Model, NMF, SFA, RandomForest}
import BIDMach.networks.DNN
import BIDMach.datasources.{DataSource, MatDS, FilesDS, SFilesDS}
import BIDMach.mixins.{CosineSim, Perplexity, Top, L1Regularizer, L2Regularizer}
import BIDMach.updaters.{ADAGrad, Batch, BatchNorm, IncMult, IncNorm, Telescoping}
import BIDMach.causal.IPTW
1 CUDA device found, CUDA version 7.0

Loading scripts/bn_test.ssc...
data: BIDMat.FMat =
   0   1   1   0   0   0   0   0   1   1   1   0   0   0   0   1   2   1   2   2   0   1   0   0   0   2   1   2   0   2   1   2   2   1   1   2   0   1   0   0   0   2   2   1   0   1   0   0   1...
   0   2   0   2   0   1   2   1   0   0   0   2   0   2   1   2   0   0   2   1   1   1   1   1   1   1   0   0   0   0   0   2   0   0   1   2   2   1   1   0   0   0   0   0   1   0   0   0   0...
   0   1   1   1   1   0   1   1   0   1   1   2   0   1   1   0   0   0   2   2   0   0   0   0   1   1   1   2   0   0   1   2   2   1   0   0   2   1   0   0   1   2   2   1   2   0   0   1   1...
  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  .. ...data_50k: BIDMat.FMat =
   0   1   1   0   0   0   0   0   1   1   1   0   0   0   0   1   2   1   2   2   0   1   0   0   0   2   1   2   0   2   1   2   2   1   1   2   0   1   0   0   0   2   2   1   0   1   0   0   1...
   0   2   0   2   0   1   2   1   0   0   0   2   0   2   1   2   0   0   2   1   1   1   1   1   1   1   0   0   0   0   0   2   0   0   1   2   2   1   1   0   0   0   0   0   1   0   0   0   0...
   0   1   1   1   1   0   1   1   0   1   1   2   0   1   1   0   0   0   2   2   0   0   0   0   1   1   1   2   0   0   1   2   2   1   0   0   2   1   0   0   1   2   2   1   2   0   0   1   1...
  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  .. ...dag: BIDMat.SMat =
(   0,   2)   1
(   0,   3)   1
(   1,   3)   1
(   3,   4)   1
states: BIDMat.IMat =
   2
   2
   2
  ..
nn: BIDMach.Learner = Learner(BIDMach.datasources.MatDS@12b89aea,BIDMach.models.BayesNet@15c28240,null,BIDMach.updaters.IncNorm@14f542e9,BIDMach.models.BayesNet$xopts$1@71fbd9be)
opts: BIDMach.Learner.Options with BIDMach.models.BayesNet.Opts with BIDMach.datasources.MatDS.Opts with BIDMach.updaters.IncNorm.Opts = BIDMach.models.BayesNet$xopts$1@71fbd9be
opts.npasses: Int = 200
opts.useGPU: Boolean = true
opts.batchSize: Int = 50000
opts.updateAll: Boolean = true
Option Name       Type          Value
===========       ====          =====
addConstFeat      boolean       false
autoReset         boolean       true
batchSize         int           50000
checkPointFile    String        null
checkPointInterval  float         0.0
copiesForSAME     int           10
cumScore          int           0
debug             int           0
debugMem          boolean       false
dim               int           5
doubleScore       boolean       false
evalStep          int           11
featThreshold     Mat           null
featType          int           1
isprob            boolean       false
npasses           int           200
numSamplesBurn    int           0
nzPerColumn       int           0
power             float         0.0
pstep             float         0.01
putBack           int           1
resFile           String        null
sample            float         1.0
samplingRate      int           1
sizeMargin        float         3.0
startBlock        int           8000
updateAll         boolean       true
useCache          boolean       true
useDouble         boolean       false
useGPU            boolean       true
warmup            long          0
randSeed = 0
pass= 0
0.62761  0 KLDiv
pass= 1
0.27608  1 KLDiv
pass= 2
0.17253  2 KLDiv
pass= 3
0.10859  3 KLDiv
pass= 4
0.070154  4 KLDiv
pass= 5
0.045697  5 KLDiv
pass= 6
0.028747  6 KLDiv
pass= 7
0.018418  7 KLDiv
pass= 8
0.012058  8 KLDiv
pass= 9
0.0085067  9 KLDiv
pass=10
0.0058010  10 KLDiv
pass=11
0.0037388  11 KLDiv
pass=12
0.0027494  12 KLDiv
pass=13
0.0020102  13 KLDiv
pass=14
0.0017062  14 KLDiv
pass=15
0.0010598  15 KLDiv
pass=16
0.00090364  16 KLDiv
pass=17
0.00066114  17 KLDiv
pass=18
0.00049130  18 KLDiv
pass=19
0.00046621  19 KLDiv
pass=20
0.00043571  20 KLDiv
pass=21
0.00033139  21 KLDiv
pass=22
0.00029500  22 KLDiv
pass=23
0.00021479  23 KLDiv
pass=24
0.00013023  24 KLDiv
pass=25
0.00016844  25 KLDiv
pass=26
0.00020087  26 KLDiv
pass=27
0.00029086  27 KLDiv
pass=28
0.00018452  28 KLDiv
pass=29
0.00018988  29 KLDiv
pass=30
0.00015430  30 KLDiv
pass=31
0.00014351  31 KLDiv
pass=32
0.00010167  32 KLDiv
pass=33
0.00010593  33 KLDiv
pass=34
0.00015269  34 KLDiv
pass=35
0.00010392  35 KLDiv
pass=36
0.00011246  36 KLDiv
pass=37
0.00012795  37 KLDiv
pass=38
0.00010655  38 KLDiv
pass=39
9.7174e-05  39 KLDiv
pass=40
0.00017190  40 KLDiv
pass=41
0.00021933  41 KLDiv
pass=42
0.00025308  42 KLDiv
pass=43
0.00024438  43 KLDiv
pass=44
0.00023060  44 KLDiv
pass=45
0.00020779  45 KLDiv
pass=46
0.00018102  46 KLDiv
pass=47
0.00016049  47 KLDiv
pass=48
0.00021142  48 KLDiv
pass=49
0.00019075  49 KLDiv
pass=50
0.00019573  50 KLDiv
pass=51
0.00018938  51 KLDiv
pass=52
0.00011653  52 KLDiv
pass=53
0.00016101  53 KLDiv
pass=54
0.00012407  54 KLDiv
pass=55
0.00013362  55 KLDiv
pass=56
0.00021464  56 KLDiv
pass=57
0.00019775  57 KLDiv
pass=58
0.00011835  58 KLDiv
pass=59
0.00020705  59 KLDiv
pass=60
0.00025952  60 KLDiv
pass=61
0.00020661  61 KLDiv
pass=62
0.00021107  62 KLDiv
pass=63
0.00019122  63 KLDiv
pass=64
0.00012188  64 KLDiv
pass=65
0.00012135  65 KLDiv
pass=66
0.00013115  66 KLDiv
pass=67
0.00011479  67 KLDiv
pass=68
9.7086e-05  68 KLDiv
pass=69
0.00012235  69 KLDiv
pass=70
0.00016126  70 KLDiv
pass=71
0.00014375  71 KLDiv
pass=72
0.00012458  72 KLDiv
pass=73
0.00015572  73 KLDiv
pass=74
0.00013677  74 KLDiv
pass=75
0.00014678  75 KLDiv
pass=76
0.00017312  76 KLDiv
pass=77
0.00028247  77 KLDiv
pass=78
0.00031668  78 KLDiv
pass=79
0.00037220  79 KLDiv
pass=80
0.00044067  80 KLDiv
pass=81
0.00040152  81 KLDiv
pass=82
0.00032292  82 KLDiv
pass=83
0.00024766  83 KLDiv
pass=84
0.00016020  84 KLDiv
pass=85
0.00016951  85 KLDiv
pass=86
0.00015509  86 KLDiv
pass=87
0.00019359  87 KLDiv
pass=88
0.00013063  88 KLDiv
pass=89
0.00013685  89 KLDiv
pass=90
0.00021350  90 KLDiv
pass=91
0.00019530  91 KLDiv
pass=92
0.00020258  92 KLDiv
pass=93
0.00017813  93 KLDiv
pass=94
0.00019668  94 KLDiv
pass=95
0.00016059  95 KLDiv
pass=96
0.00014641  96 KLDiv
pass=97
0.00013556  97 KLDiv
pass=98
0.00016102  98 KLDiv
pass=99
0.00021771  99 KLDiv
pass=100
0.00017891  100 KLDiv
pass=101
0.00018754  101 KLDiv
pass=102
0.00018500  102 KLDiv
pass=103
0.00021929  103 KLDiv
pass=104
0.00020364  104 KLDiv
pass=105
0.00028226  105 KLDiv
pass=106
0.00028413  106 KLDiv
pass=107
0.00029934  107 KLDiv
pass=108
0.00019878  108 KLDiv
pass=109
0.00026359  109 KLDiv
pass=110
0.00027646  110 KLDiv
pass=111
0.00022906  111 KLDiv
pass=112
0.00025675  112 KLDiv
pass=113
0.00020277  113 KLDiv
pass=114
0.00021842  114 KLDiv
pass=115
0.00022550  115 KLDiv
pass=116
0.00016253  116 KLDiv
pass=117
0.00014151  117 KLDiv
pass=118
0.00016567  118 KLDiv
pass=119
0.00013261  119 KLDiv
pass=120
0.00018316  120 KLDiv
pass=121
0.00015173  121 KLDiv
pass=122
0.00020814  122 KLDiv
pass=123
0.00020799  123 KLDiv
pass=124
0.00019981  124 KLDiv
pass=125
0.00020074  125 KLDiv
pass=126
0.00015959  126 KLDiv
pass=127
0.00016372  127 KLDiv
pass=128
0.00019067  128 KLDiv
pass=129
0.00013862  129 KLDiv
pass=130
0.00015295  130 KLDiv
pass=131
0.00018080  131 KLDiv
pass=132
0.00014409  132 KLDiv
pass=133
0.00017896  133 KLDiv
pass=134
0.00028042  134 KLDiv
pass=135
0.00018544  135 KLDiv
pass=136
0.00013232  136 KLDiv
pass=137
0.00015808  137 KLDiv
pass=138
0.00017258  138 KLDiv
pass=139
0.00014377  139 KLDiv
pass=140
0.00018169  140 KLDiv
pass=141
0.00014679  141 KLDiv
pass=142
0.00014546  142 KLDiv
pass=143
0.00011498  143 KLDiv
pass=144
0.00012169  144 KLDiv
pass=145
0.00015032  145 KLDiv
pass=146
0.00014862  146 KLDiv
pass=147
0.00020774  147 KLDiv
pass=148
0.00016864  148 KLDiv
pass=149
0.00016150  149 KLDiv
pass=150
0.00025559  150 KLDiv
pass=151
0.00013746  151 KLDiv
pass=152
0.00011656  152 KLDiv
pass=153
0.00013610  153 KLDiv
pass=154
0.00010517  154 KLDiv
pass=155
0.00013727  155 KLDiv
pass=156
8.5308e-05  156 KLDiv
pass=157
0.00012443  157 KLDiv
pass=158
0.00012934  158 KLDiv
pass=159
9.2374e-05  159 KLDiv
pass=160
8.8114e-05  160 KLDiv
pass=161
0.00012524  161 KLDiv
pass=162
0.00017858  162 KLDiv
pass=163
0.00017966  163 KLDiv
pass=164
0.00012521  164 KLDiv
pass=165
0.00020726  165 KLDiv
pass=166
0.00023304  166 KLDiv
pass=167
0.00019077  167 KLDiv
pass=168
0.00028601  168 KLDiv
pass=169
0.00027294  169 KLDiv
pass=170
0.00023514  170 KLDiv
pass=171
0.00020448  171 KLDiv
pass=172
0.00014633  172 KLDiv
pass=173
0.00015955  173 KLDiv
pass=174
0.00017527  174 KLDiv
pass=175
0.00017258  175 KLDiv
pass=176
0.00017138  176 KLDiv
pass=177
0.00019150  177 KLDiv
pass=178
0.00018773  178 KLDiv
pass=179
0.00017249  179 KLDiv
pass=180
0.00014919  180 KLDiv
pass=181
0.00014831  181 KLDiv
pass=182
0.00018238  182 KLDiv
pass=183
0.00016215  183 KLDiv
pass=184
0.00012624  184 KLDiv
pass=185
0.00011634  185 KLDiv
pass=186
9.5251e-05  186 KLDiv
pass=187
0.00010785  187 KLDiv
pass=188
0.00013413  188 KLDiv
pass=189
0.00015910  189 KLDiv
pass=190
0.00017791  190 KLDiv
pass=191
0.00013913  191 KLDiv
pass=192
0.00017838  192 KLDiv
pass=193
0.00017106  193 KLDiv
pass=194
0.00013604  194 KLDiv
pass=195
9.5078e-05  195 KLDiv
pass=196
0.00013723  196 KLDiv
pass=197
0.00015196  197 KLDiv
pass=198
0.00018624  198 KLDiv
pass=199
0.00020174  199 KLDiv
Time=8.2790 secs, gflops=8.49
java.lang.IndexOutOfBoundsException: 0
  at scala.collection.mutable.ListBuffer.apply(ListBuffer.scala:126)
  at BIDMach.Learner$.scores2FMat(Learner.scala:798)
  at BIDMach.Learner.retrain(Learner.scala:134)
  at BIDMach.Learner.train(Learner.scala:56)
  ... 54 elided
res4: BIDMat.Mat = 0.70715,0.29285,0.60256,0.39744,0.94574,0.054262,0.19387,0.80613,0.29495,0.40447,0.30058,0.048810,0.25445,0.69674,0.89269,0.089763,0.017550,0.49451,0.29839,0.20710,0.10649,0.89351,0.40209,0.59791,0.99031,0.0096928
